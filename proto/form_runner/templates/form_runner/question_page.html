{% from "govuk_frontend_jinja/components/back-link/macro.html" import govukBackLink %}
{% from "govuk_frontend_jinja/components/error-summary/macro.html" import govukErrorSummary %}

{% extends "apply/base.jinja.html" %}

{% block pageTitle %}{% trans %}Application{% endtrans %} {{ application.code }} - {% trans %}Apply for funding{% endtrans %}{% endblock %}

{% block beforeContent %}
{{ super() }}
<div class="govuk-phase-banner">
    <div class="proto-phase govuk-!-padding-top-1 govuk-!-padding-bottom-1">
        <p class="govuk-phase-banner__content">
            {% set email %}<strong class="govuk-!-font-weight-bold">{{ account.email }}</strong>{% endset %}
            <span class="govuk-phase-banner__text">{% trans email=email %}You are applying as {{ email }}{% endtrans %}</span>
        </p>
    </div>
</div>


{% if back_link %}
  {{ govukBackLink({
    "text": _("Back"),
    "href": back_link
  }) }}
{% endif %}
{% endblock %}

{% block content %}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    {% if form.errors %}
        {{ govukErrorSummary(wtforms_errors(form)) }}
    {% endif %}

    <form method="post" novalidate>
      {{ form.csrf_token }}

      <span class="govuk-caption-l">{{ section.title }}</span>

      {% if question.type == QuestionType.TEXT_INPUT %}
        {{ form.question(params={"label": {"isPageHeading": true, "classes": "govuk-label--l"} }) }}
      {% elif question.type == QuestionType.TEXTAREA %}
        {{ form.question(params={"label": {"isPageHeading": true, "classes": "govuk-label--l"} }) }}
      {% elif question.type == QuestionType.RADIOS %}
        {# govuk-frontend-wtf doesn't seem to be merging this properly - without explicitly re-setting fieldset.legend.text, there's no visible question =[ #}
        {{ form.question(params={"fieldset": {"legend": {"isPageHeading": true, "classes": "govuk-fieldset__legend--l", "text": form.question.label.text} } }) }}
      {% endif %}

      {{ form.submit }}
    </form>
  </div>
</div>
{% endblock %}
